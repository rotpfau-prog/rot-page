<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>rotpfau</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    
    <script>
    // Omada Auto-Authorization Script
    (function() {
        // Parse URL parameters from Omada
        const params = new URLSearchParams(window.location.search);
        const clientMac = params.get('clientMac');
        const clientIp = params.get('clientIp');
        const apMac = params.get('apMac');
        const ssidName = params.get('ssidName');
        const radioId = params.get('radioId');
        const site = params.get('site');
        const t = params.get('t');
        
        // Only run if Omada parameters are present
        if (clientMac && site) {
            console.log('Omada parameters detected, auto-authorizing...');
            
            // Construct authorization URL
            const authUrl = `http://192.168.0.1:8080/portal/auth`;
            
            // Create authorization form data
            const formData = new URLSearchParams({
                clientMac: clientMac,
                clientIp: clientIp,
                apMac: apMac,
                ssidName: ssidName,
                radioId: radioId,
                site: site,
                t: t,
                action: 'authorize'
            });
            
            // Send authorization request
            fetch(authUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: formData.toString(),
                mode: 'no-cors'
            }).then(() => {
                console.log('Authorization sent');
            }).catch(() => {
                console.log('Authorization request completed');
            });
            
            // Wait 5 seconds then redirect to your Omada controller
            setTimeout(() => {
                window.location.href = 'https://aps1-omada-essential-controller.tplinkcloud.com';
            }, 5000);
        }
    })();
    </script>
  </body>
</html>
